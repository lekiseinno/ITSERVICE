!function(e){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=function(t,s){return t||(t=window),s&&s.fn.dataTable||(s=require("datatables.net")(t,s).$),e(s,t,t.document)}:e(jQuery,window,document)}(function(e,t,s,n){"use strict";var i=e.fn.dataTable,o=function(t,s){if(!i.versionCheck||!i.versionCheck("1.10.8"))throw"KeyTable requires DataTables 1.10.8 or newer";this.c=e.extend(!0,{},i.defaults.keyTable,o.defaults,s),this.s={dt:new i.Api(t),enable:!0,focusDraw:!1,waitingForDraw:!1,lastFocus:null},this.dom={};var n=this.s.dt.settings()[0],l=n.keytable;if(l)return l;n.keytable=this,this._constructor()};return e.extend(o.prototype,{blur:function(){this._blur()},enable:function(e){this.s.enable=e},focus:function(e,t){this._focus(this.s.dt.cell(e,t))},focused:function(e){if(!this.s.lastFocus)return!1;var t=this.s.lastFocus.cell.index();return e.row===t.row&&e.column===t.column},_constructor:function(){this._tabInput();var t=this,n=this.s.dt,i=e(n.table().node());if("static"===i.css("position")&&i.css("position","relative"),e(n.table().body()).on("click.keyTable","th, td",function(e){if(!1!==t.s.enable){var s=n.cell(this);s.any()&&t._focus(s,null,!1,e)}}),e(s).on("keydown.keyTable",function(e){t._key(e)}),this.c.blurable&&e(s).on("mousedown.keyTable",function(s){e(s.target).parents(".dataTables_filter").length&&t._blur(),e(s.target).parents().filter(n.table().container()).length||e(s.target).parents("div.DTE").length||e(s.target).parents("div.editor-datetime").length||e(s.target).parents().filter(".DTFC_Cloned").length||t._blur()}),this.c.editor){var o=this.c.editor;o.on("open.keyTableMain",function(e,s,n){"inline"!==s&&t.s.enable&&(t.enable(!1),o.one("close.keyTable",function(){t.enable(!0)}))}),this.c.editOnFocus&&n.on("key-focus.keyTable key-refocus.keyTable",function(e,s,n,i){t._editor(null,i)}),n.on("key.keyTable",function(e,s,n,i,o){t._editor(n,o)})}n.settings()[0].oFeatures.bStateSave&&n.on("stateSaveParams.keyTable",function(e,s,n){n.keyTable=t.s.lastFocus?t.s.lastFocus.cell.index():null}),n.on("draw.keyTable",function(i){if(!t.s.focusDraw){var o=t.s.lastFocus;if(o&&o.node&&e(o.node).closest("body")===s.body){var l=t.s.lastFocus.relative,a=n.page.info(),r=l.row+a.start;if(0===a.recordsDisplay)return;r>=a.recordsDisplay&&(r=a.recordsDisplay-1),t._focus(r,l.column,!0,i)}}}),n.on("destroy.keyTable",function(){n.off(".keyTable"),e(n.table().body()).off("click.keyTable","th, td"),e(s.body).off("keydown.keyTable").off("click.keyTable")});var l=n.state.loaded();l&&l.keyTable?n.one("init",function(){var e=n.cell(l.keyTable);e.any()&&e.focus()}):this.c.focus&&n.cell(this.c.focus).focus()},_blur:function(){if(this.s.enable&&this.s.lastFocus){var t=this.s.lastFocus.cell;e(t.node()).removeClass(this.c.className),this.s.lastFocus=null,this._updateFixedColumns(t.index().column),this._emitEvent("key-blur",[this.s.dt,t])}},_clipboardCopy:function(){var n=this.s.dt;if(this.s.lastFocus&&t.getSelection&&!t.getSelection().toString()){var i=this.s.lastFocus.cell.render("display"),o=e("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0}),l=e("<textarea readonly/>").val(i).appendTo(o);try{o.appendTo(n.table().container()),l[0].focus(),l[0].select(),s.execCommand("copy")}catch(e){}o.remove()}},_columns:function(){var e=this.s.dt,t=e.columns(this.c.columns).indexes(),s=[];return e.columns(":visible").every(function(e){-1!==t.indexOf(e)&&s.push(e)}),s},_editor:function(t,s){var n=this,i=this.s.dt,o=this.c.editor;e("div.DTE",this.s.lastFocus.cell.node()).length||16!==t&&(s.stopPropagation(),13===t&&s.preventDefault(),o.one("open.keyTable",function(){o.off("cancelOpen.keyTable"),n.c.editAutoSelect&&e("div.DTE_Field_InputControl input, div.DTE_Field_InputControl textarea").select(),i.keys.enable(n.c.editorKeys),i.one("key-blur.editor",function(){o.displayed()&&o.submit()}),o.one("close",function(){i.keys.enable(!0),i.off("key-blur.editor")})}).one("cancelOpen.keyTable",function(){o.off("open.keyTable")}).inline(this.s.lastFocus.cell.index()))},_emitEvent:function(t,s){this.s.dt.iterator("table",function(n,i){e(n.nTable).triggerHandler(t,s)})},_focus:function(i,o,l,a){var r=this,c=this.s.dt,u=c.page.info(),d=this.s.lastFocus;if(a||(a=null),this.s.enable){if("number"!=typeof i){var f=i.index();o=f.column,i=c.rows({filter:"applied",order:"applied"}).indexes().indexOf(f.row),u.serverSide&&(i+=u.start)}if(-1!==u.length&&(i<u.start||i>=u.start+u.length))return this.s.focusDraw=!0,this.s.waitingForDraw=!0,void c.one("draw",function(){r.s.focusDraw=!1,r.s.waitingForDraw=!1,r._focus(i,o,n,a)}).page(Math.floor(i/u.length)).draw(!1);if(-1!==e.inArray(o,this._columns())){u.serverSide&&(i-=u.start);var h=c.cells(null,o,{search:"applied",order:"applied"}).flatten(),b=c.cell(h[i]);if(d){if(d.node===b.node())return void this._emitEvent("key-refocus",[this.s.dt,b,a||null]);this._blur()}var y=e(b.node());if(y.addClass(this.c.className),this._updateFixedColumns(o),l===n||!0===l){this._scroll(e(t),e(s.body),y,"offset");var p=c.table().body().parentNode;if(p!==c.table().header().parentNode){var v=e(p.parentNode);this._scroll(v,v,y,"position")}}this.s.lastFocus={cell:b,node:b.node(),relative:{row:c.rows({page:"current"}).indexes().indexOf(b.index().row),column:b.index().column}},this._emitEvent("key-focus",[this.s.dt,b,a||null]),c.state.save()}}},_key:function(t){if(this.s.waitingForDraw)t.preventDefault();else{var s=this.s.enable,n=!0===s||"navigation-only"===s;if(s)if(t.ctrlKey&&67===t.keyCode)this._clipboardCopy();else if(!(0===t.keyCode||t.ctrlKey||t.metaKey||t.altKey))if(this.s.lastFocus){var i=this.s.dt;if(!this.c.keys||-1!==e.inArray(t.keyCode,this.c.keys))switch(t.keyCode){case 9:this._shift(t,t.shiftKey?"left":"right",!0);break;case 27:this.s.blurable&&!0===s&&this._blur();break;case 33:case 34:n&&(t.preventDefault(),i.page(33===t.keyCode?"previous":"next").draw(!1));break;case 35:case 36:if(n){t.preventDefault();var o=i.cells({page:"current"}).indexes(),l=this._columns();this._focus(i.cell(o[35===t.keyCode?o.length-1:l[0]]),null,!0,t)}break;case 37:n&&this._shift(t,"left");break;case 38:n&&this._shift(t,"up");break;case 39:n&&this._shift(t,"right");break;case 40:n&&this._shift(t,"down");break;default:!0===s&&this._emitEvent("key",[i,t.keyCode,this.s.lastFocus.cell,t])}}}},_scroll:function(e,t,s,n){var i=s[n](),o=s.outerHeight(),l=s.outerWidth(),a=t.scrollTop(),r=t.scrollLeft(),c=e.height(),u=e.width();"position"===n&&(i.top+=parseInt(s.closest("table").css("top"),10)),i.top<a&&t.scrollTop(i.top),i.left<r&&t.scrollLeft(i.left),i.top+o>a+c&&o<c&&t.scrollTop(i.top+o-c),i.left+l>r+u&&l<u&&t.scrollLeft(i.left+l-u)},_shift:function(t,s,n){var i=this.s.dt,o=i.page.info(),l=o.recordsDisplay,a=this.s.lastFocus.cell,r=this._columns();if(a){var c=i.rows({filter:"applied",order:"applied"}).indexes().indexOf(a.index().row);o.serverSide&&(c+=o.start);var u=i.columns(r).indexes().indexOf(a.index().column),d=c,f=r[u];"right"===s?u>=r.length-1?(d++,f=r[0]):f=r[u+1]:"left"===s?0===u?(d--,f=r[r.length-1]):f=r[u-1]:"up"===s?d--:"down"===s&&d++,d>=0&&d<l&&-1!==e.inArray(f,r)?(t.preventDefault(),this._focus(d,f,!0,t)):n&&this.c.blurable?this._blur():t.preventDefault()}},_tabInput:function(){var t=this,s=this.s.dt,n=null!==this.c.tabIndex?this.c.tabIndex:s.settings()[0].iTabIndex;-1!=n&&e('<div><input type="text" tabindex="'+n+'"/></div>').css({position:"absolute",height:1,width:0,overflow:"hidden"}).insertBefore(s.table().node()).children().on("focus",function(e){s.cell(":eq(0)",{page:"current"}).any()&&t._focus(s.cell(":eq(0)","0:visible",{page:"current"}),null,!0,e)})},_updateFixedColumns:function(e){var t=this.s.dt,s=t.settings()[0];if(s._oFixedColumns){var n=s._oFixedColumns.s.iLeftColumns,i=s.aoColumns.length-s._oFixedColumns.s.iRightColumns;(e<n||e>=i)&&t.fixedColumns().update()}}}),o.defaults={blurable:!0,className:"focus",columns:"",editor:null,editorKeys:"navigation-only",editAutoSelect:!0,editOnFocus:!1,focus:null,keys:null,tabIndex:null},o.version="2.3.2",e.fn.dataTable.KeyTable=o,e.fn.DataTable.KeyTable=o,i.Api.register("cell.blur()",function(){return this.iterator("table",function(e){e.keytable&&e.keytable.blur()})}),i.Api.register("cell().focus()",function(){return this.iterator("cell",function(e,t,s){e.keytable&&e.keytable.focus(t,s)})}),i.Api.register("keys.disable()",function(){return this.iterator("table",function(e){e.keytable&&e.keytable.enable(!1)})}),i.Api.register("keys.enable()",function(e){return this.iterator("table",function(t){t.keytable&&t.keytable.enable(e===n||e)})}),i.ext.selector.cell.push(function(e,t,s){var i=t.focused,o=e.keytable,l=[];if(!o||i===n)return s;for(var a=0,r=s.length;a<r;a++)(!0===i&&o.focused(s[a])||!1===i&&!o.focused(s[a]))&&l.push(s[a]);return l}),e(s).on("preInit.dt.dtk",function(t,s,n){if("dt"===t.namespace){var l=s.oInit.keys,a=i.defaults.keys;if(l||a){var r=e.extend({},a,l);!1!==l&&new o(s,r)}}}),o});